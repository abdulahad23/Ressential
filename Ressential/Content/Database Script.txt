-- Table: Users
CREATE TABLE Users (
    UserId INT PRIMARY KEY IDENTITY(1,1),
    UserName NVARCHAR(100) NOT NULL,
    Email NVARCHAR(100) NOT NULL UNIQUE,
    Password NVARCHAR(255) NOT NULL,
    IsActive BIT NOT NULL DEFAULT 1,
    CreatedAt DATETIME2 NOT NULL DEFAULT GETDATE()
);

-- Table: Roles
CREATE TABLE Roles (
    RoleId INT PRIMARY KEY IDENTITY(1,1),
    RoleName NVARCHAR(100) NOT NULL UNIQUE,
    CreatedAt DATETIME2 NOT NULL DEFAULT GETDATE()
);

-- Table: Permissions
CREATE TABLE Permissions (
    PermissionId INT PRIMARY KEY IDENTITY(1,1),
    PermissionName NVARCHAR(100) NOT NULL UNIQUE,
    Description NVARCHAR(255) NULL,
    CreatedAt DATETIME2 NOT NULL DEFAULT GETDATE()
);

-- Table: RolePermissions
CREATE TABLE RolePermissions (
    RoleId INT NOT NULL,
    PermissionId INT NOT NULL,
    PRIMARY KEY (RoleId, PermissionId),
    FOREIGN KEY (RoleId) REFERENCES Roles(RoleId) ON DELETE CASCADE,
    FOREIGN KEY (PermissionId) REFERENCES Permissions(PermissionId) ON DELETE CASCADE
);

-- Table: UserRoles
CREATE TABLE UserRoles (
    UserId INT NOT NULL,
    RoleId INT NOT NULL,
    PRIMARY KEY (UserId, RoleId),
    FOREIGN KEY (UserId) REFERENCES Users(UserId) ON DELETE CASCADE,
    FOREIGN KEY (RoleId) REFERENCES Roles(RoleId) ON DELETE CASCADE
);

-- Table: UnitOfMeasure
CREATE TABLE UnitOfMeasure (
    UnitOfMeasureId INT PRIMARY KEY IDENTITY(1,1),
    Name NVARCHAR(50) NOT NULL,
    Symbol NVARCHAR(10) NOT NULL
);

-- Table: ItemCategory
CREATE TABLE ItemCategory (
    ItemCategoryId INT PRIMARY KEY IDENTITY(1,1),
    ItemCategoryName NVARCHAR(100) NOT NULL,
    Description NVARCHAR(500) NULL
);

-- Table: Items
CREATE TABLE Items (
    ItemId INT PRIMARY KEY IDENTITY(1,1),
    ItemName NVARCHAR(100) NOT NULL,
    Sku NVARCHAR(50) NOT NULL UNIQUE,
    ItemCategoryId INT NOT NULL,
    UnitOfMeasureId INT NOT NULL,
    MinimumStockLevel DECIMAL(18,2) NOT NULL DEFAULT 0,
    CostingMethod NVARCHAR(10) CHECK (CostingMethod IN ('FIFO', 'Average')),
    IsActive BIT NOT NULL DEFAULT 1,
    CreatedBy INT NOT NULL,
    CreatedAt DATETIME2 NOT NULL DEFAULT GETDATE(),
    ModifiedBy INT NULL,
    ModifiedAt DATETIME2 NULL,
    FOREIGN KEY (ItemCategoryId) REFERENCES ItemCategory(ItemCategoryId),
    FOREIGN KEY (UnitOfMeasureId) REFERENCES UnitOfMeasure(UnitOfMeasureId),
    FOREIGN KEY (CreatedBy) REFERENCES Users(UserId),
    FOREIGN KEY (ModifiedBy) REFERENCES Users(UserId)
);

-- Table: Vendors
CREATE TABLE Vendors (
    VendorId INT PRIMARY KEY IDENTITY(1,1),
    Name NVARCHAR(100) NOT NULL,
    CompanyName NVARCHAR(100) NULL,
    Email NVARCHAR(100) NULL,
    Contact NVARCHAR(50) NOT NULL,
    Address NVARCHAR(255) NULL,
    City NVARCHAR(100) NOT NULL,
    Country NVARCHAR(100) NOT NULL,
    PostalCode NVARCHAR(20) NULL,
    CreatedBy INT NOT NULL,
    CreatedAt DATETIME2 NOT NULL DEFAULT GETDATE(),
    FOREIGN KEY (CreatedBy) REFERENCES Users(UserId)
);

-- Table: Branches
CREATE TABLE Branches (
    BranchId INT PRIMARY KEY IDENTITY(1,1),
    BranchName NVARCHAR(100) NOT NULL,
    BranchCode NVARCHAR(50) NOT NULL UNIQUE,
    BranchContact NVARCHAR(50) NOT NULL,
    Address NVARCHAR(255) NOT NULL,
    City NVARCHAR(100) NOT NULL,
    Country NVARCHAR(100) NOT NULL,
    PostalCode NVARCHAR(20) NULL,
    OwnerName NVARCHAR(100) NOT NULL,
    IsActive BIT NOT NULL DEFAULT 1,
    CreatedAt DATETIME2 NOT NULL DEFAULT GETDATE()
);

-- Table: Purchases
CREATE TABLE Purchases (
    PurchaseId INT PRIMARY KEY IDENTITY(1,1),
    PurchaseDate DATETIME2 NOT NULL,
    PurchaseNo NVARCHAR(50) NOT NULL UNIQUE,
    ReferenceNo NVARCHAR(50) NULL,
    VendorId INT NOT NULL,
    Memo NVARCHAR(255) NULL,
    CreatedBy INT NOT NULL,
    CreatedAt DATETIME2 NOT NULL DEFAULT GETDATE(),
    ModifiedBy INT NULL,
    ModifiedAt DATETIME2 NULL,
    FOREIGN KEY (VendorId) REFERENCES Vendors(VendorId),
    FOREIGN KEY (CreatedBy) REFERENCES Users(UserId),
    FOREIGN KEY (ModifiedBy) REFERENCES Users(UserId)
);

-- Table: PurchaseDetails
CREATE TABLE PurchaseDetails (
    PurchaseId INT NOT NULL,
    ItemId INT NOT NULL,
    Quantity DECIMAL(18,2) NOT NULL,
    UnitPrice DECIMAL(18,2) NOT NULL,
    Description NVARCHAR(255) NULL,
    FOREIGN KEY (PurchaseId) REFERENCES Purchases(PurchaseId) ON DELETE CASCADE,
    FOREIGN KEY (ItemId) REFERENCES Items(ItemId),
    PRIMARY KEY (PurchaseId, ItemId)
);

-- Table: Requisitions
CREATE TABLE Requisitions (
    RequisitionId INT PRIMARY KEY IDENTITY(1,1),
    RequisitionNo NVARCHAR(50) NOT NULL UNIQUE,
    RequisitionDate DATETIME2 NOT NULL,
    BranchId INT NOT NULL,
    Description NVARCHAR(255) NULL,
    Status NVARCHAR(20) NOT NULL CHECK (Status IN ('Pending', 'Approved', 'Rejected')),
    CreatedBy INT NOT NULL,
    CreatedAt DATETIME2 NOT NULL DEFAULT GETDATE(),
    ModifiedBy INT NULL,
    ModifiedAt DATETIME2 NULL,
    FOREIGN KEY (BranchId) REFERENCES Branches(BranchId),
    FOREIGN KEY (CreatedBy) REFERENCES Users(UserId),
    FOREIGN KEY (ModifiedBy) REFERENCES Users(UserId)
);

-- Table: RequisitionDetails
CREATE TABLE RequisitionDetails (
    RequisitionId INT NOT NULL,
    ItemId INT NOT NULL,
    Description NVARCHAR(255) NULL,
    Quantity DECIMAL(18,2) NOT NULL,
    FOREIGN KEY (RequisitionId) REFERENCES Requisitions(RequisitionId) ON DELETE CASCADE,
    FOREIGN KEY (ItemId) REFERENCES Items(ItemId),
    PRIMARY KEY (RequisitionId,ItemId)
);

-- Table: WarehouseIssues
CREATE TABLE WarehouseIssues (
    IssueId INT PRIMARY KEY IDENTITY(1,1),
    IssueDate DATETIME2 NOT NULL,
    IssueNo NVARCHAR(50) NOT NULL UNIQUE,
    ReferenceNo NVARCHAR(50) NULL,
    BranchID INT NOT NULL,
    Memo NVARCHAR(255) NULL,
    Status NVARCHAR(20) NOT NULL CHECK (Status IN ('Pending', 'Approved', 'Rejected')),
    CreatedBy INT NOT NULL,
    CreatedAt DATETIME2 NOT NULL DEFAULT GETDATE(),
    ModifiedBy INT NULL,
    ModifiedAt DATETIME2 NULL,
    FOREIGN KEY (BranchID) REFERENCES Branches(BranchId),
    FOREIGN KEY (CreatedBy) REFERENCES Users(UserId),
    FOREIGN KEY (ModifiedBy) REFERENCES Users(UserId)
);

-- Table: WarehouseIssueDetails
CREATE TABLE WarehouseIssueDetails (
    IssueId INT NOT NULL,
    RequisitionId INT NULL,
    ItemId INT NOT NULL,
    Quantity DECIMAL(18,2) NOT NULL,
    CostApplied DECIMAL(18,2) NOT NULL,
    FOREIGN KEY (IssueId) REFERENCES WarehouseIssues(IssueId) ON DELETE CASCADE,
    FOREIGN KEY (RequisitionId) REFERENCES Requisitions(RequisitionId) ON DELETE SET NULL,
    FOREIGN KEY (ItemId) REFERENCES Items(ItemId),
    PRIMARY KEY (IssueId,ItemId)
);

-- Table: PurchasesReturn
CREATE TABLE PurchasesReturn (
    PurchaseReturnId INT PRIMARY KEY IDENTITY(1,1),
    PurchaseReturnDate DATETIME2 NOT NULL,
    PurchaseReturnNo NVARCHAR(50) NOT NULL UNIQUE,
    ReferenceNo NVARCHAR(50) NULL,
    VendorID INT NOT NULL,
    Memo NVARCHAR(255) NULL,
    CreatedBy INT NOT NULL,
    CreatedAt DATETIME2 NOT NULL DEFAULT GETDATE(),
    ModifiedBy INT NULL,
    ModifiedAt DATETIME2 NULL,
    FOREIGN KEY (VendorID) REFERENCES Vendors(VendorId),
    FOREIGN KEY (CreatedBy) REFERENCES Users(UserId),
    FOREIGN KEY (ModifiedBy) REFERENCES Users(UserId)
);

-- Table: PurchasesReturnDetails
CREATE TABLE PurchasesReturnDetails (
    PurchasesReturnId INT NOT NULL,
    ItemId INT NOT NULL,
    Quantity DECIMAL(18,2) NOT NULL,
    UnitPrice DECIMAL(18,2) NOT NULL,
    Description NVARCHAR(255) NULL,
    FOREIGN KEY (PurchasesReturnId) REFERENCES PurchasesReturn(PurchaseReturnId) ON DELETE CASCADE,
    FOREIGN KEY (ItemId) REFERENCES Items(ItemId),
    PRIMARY KEY (PurchasesReturnId,ItemId)
);

-- Table: BranchItemDetails
CREATE TABLE BranchItemDetails (
    BranchId INT NOT NULL,
    ItemId INT NOT NULL,
    MinimumStockLevel DECIMAL(18,2) NOT NULL DEFAULT 0,
    FOREIGN KEY (BranchId) REFERENCES Branches(BranchId) ON DELETE CASCADE,
    FOREIGN KEY (ItemId) REFERENCES Items(ItemId),
    PRIMARY KEY (BranchId,ItemId)
);

-- Table: ReturnStock
CREATE TABLE ReturnStock (
    ReturnStockId INT PRIMARY KEY IDENTITY(1,1),
    ReturnDate DATETIME2 NOT NULL,
    ReturnNo NVARCHAR(50) NOT NULL UNIQUE,
    ReferenceNo NVARCHAR(50) NULL,
    BranchId INT NOT NULL,
    Description NVARCHAR(255) NULL,
    Status NVARCHAR(20) NOT NULL CHECK (Status IN ('Pending', 'Approved', 'Rejected')),
    CreatedBy INT NOT NULL,
    CreatedAt DATETIME2 NOT NULL DEFAULT GETDATE(),
    ModifiedBy INT NULL,
    ModifiedAt DATETIME2 NULL,
    FOREIGN KEY (BranchId) REFERENCES Branches(BranchId),
    FOREIGN KEY (CreatedBy) REFERENCES Users(UserId),
    FOREIGN KEY (ModifiedBy) REFERENCES Users(UserId)
);

-- Table: ReturnStockDetails
CREATE TABLE ReturnStockDetails (
    ReturnStockId INT NOT NULL,
    ItemId INT NOT NULL,
    Description NVARCHAR(255) NULL,
    ItemQuantity DECIMAL(18,2) NOT NULL,
    FOREIGN KEY (ReturnStockId) REFERENCES ReturnStock(ReturnStockId) ON DELETE CASCADE,
    FOREIGN KEY (ItemId) REFERENCES Items(ItemId),
    PRIMARY KEY (ReturnStockId,ItemId)
);

-- Table: ConsumeItems
CREATE TABLE ConsumeItems (
    ConsumeItemId INT PRIMARY KEY IDENTITY(1,1),
    ConsumeItemDate DATETIME2 NOT NULL,
    ReferenceNo NVARCHAR(50) NOT NULL UNIQUE,
    BranchId INT NOT NULL,
    Description NVARCHAR(255) NULL,
    CreatedBy INT NOT NULL,
    CreatedAt DATETIME2 NOT NULL DEFAULT GETDATE(),
    ModifiedBy INT NULL,
    ModifiedAt DATETIME2 NULL,
    FOREIGN KEY (BranchId) REFERENCES Branches(BranchId),
    FOREIGN KEY (CreatedBy) REFERENCES Users(UserId),
    FOREIGN KEY (ModifiedBy) REFERENCES Users(UserId)
);

-- Table: ConsumeItemDetails
CREATE TABLE ConsumeItemDetails (
    ConsumeItemId INT NOT NULL,
    ItemId INT NOT NULL,
    Description NVARCHAR(255) NULL,
    ItemQuantity DECIMAL(18,2) NOT NULL,
    FOREIGN KEY (ConsumeItemId) REFERENCES ConsumeItems(ConsumeItemId) ON DELETE CASCADE,
    FOREIGN KEY (ItemId) REFERENCES Items(ItemId),
    PRIMARY KEY (ConsumeItemId,ItemId)
);

-- Table: WastageItems
CREATE TABLE WastageItems (
    WastageItemId INT PRIMARY KEY IDENTITY(1,1),
    WastageItemDate DATETIME2 NOT NULL,
    ReferenceNo NVARCHAR(50) NOT NULL UNIQUE,
    BranchId INT NOT NULL,
    Description NVARCHAR(255) NULL,
    CreatedBy INT NOT NULL,
    CreatedAt DATETIME2 NOT NULL DEFAULT GETDATE(),
    ModifiedBy INT NULL,
    ModifiedAt DATETIME2 NULL,
    FOREIGN KEY (BranchId) REFERENCES Branches(BranchId),
    FOREIGN KEY (CreatedBy) REFERENCES Users(UserId),
    FOREIGN KEY (ModifiedBy) REFERENCES Users(UserId)
);

-- Table: WastageItemDetails
CREATE TABLE WastageItemDetails (
    WastageItemId INT NOT NULL,
    ItemId INT NOT NULL,
    Description NVARCHAR(255) NULL,
    ItemQuantity DECIMAL(18,2) NOT NULL,
    FOREIGN KEY (WastageItemId) REFERENCES WastageItems(WastageItemId) ON DELETE CASCADE,
    FOREIGN KEY (ItemId) REFERENCES Items(ItemId),
    PRIMARY KEY (WastageItemId,ItemId)
);

-- Table: ProductCategories
CREATE TABLE ProductCategories (
    ProductCategoryId INT PRIMARY KEY IDENTITY(1,1),
    ProductCategoryName NVARCHAR(100) NOT NULL,
    Description NVARCHAR(255) NULL,
    CreatedBy INT NOT NULL,
    CreatedAt DATETIME2 NOT NULL DEFAULT GETDATE(),
    FOREIGN KEY (CreatedBy) REFERENCES Users(UserId)
);

-- Table: Products
CREATE TABLE Products (
    ProductId INT PRIMARY KEY IDENTITY(1,1),
    ProductCode NVARCHAR(50) NOT NULL UNIQUE,
    ProductName NVARCHAR(100) NOT NULL,
    BranchId INT NOT NULL,
    ProductImage VARBINARY(MAX) NULL,
    ProductPrice DECIMAL(18,2) NOT NULL,
    Description NVARCHAR(255) NULL,
    ProductCategoryId INT NOT NULL,
    ChefID INT NULL,
    Status NVARCHAR(20) NOT NULL CHECK (Status IN ('Available', 'Not Available')),
    CreatedBy INT NOT NULL,
    CreatedAt DATETIME2 NOT NULL DEFAULT GETDATE(),
    ModifiedBy INT NULL,
    ModifiedAt DATETIME2 NULL,
    FOREIGN KEY (BranchId) REFERENCES Branches(BranchId),
    FOREIGN KEY (ProductCategoryId) REFERENCES ProductCategories(ProductCategoryId),
    FOREIGN KEY (CreatedBy) REFERENCES Users(UserId),
    FOREIGN KEY (ModifiedBy) REFERENCES Users(UserId)
);

-- Table: ProductItemDetails
CREATE TABLE ProductItemDetails (
    ProductId INT NOT NULL,
    ItemId INT NOT NULL,
    ItemQuantity DECIMAL(18,2) NOT NULL,
    FOREIGN KEY (ProductId) REFERENCES Products(ProductId) ON DELETE CASCADE,
    FOREIGN KEY (ItemId) REFERENCES Items(ItemId),
    PRIMARY KEY (ProductId,ItemId)
);

-- Table: Customers
CREATE TABLE Customers (
    CustomerId INT PRIMARY KEY IDENTITY(1,1),
    CustomerName NVARCHAR(100) NOT NULL,
    ContactNo NVARCHAR(20) NOT NULL,
    Address NVARCHAR(255) NULL,
    City NVARCHAR(100) NULL,
    Country NVARCHAR(100) NULL
);

-- Table: Orders
CREATE TABLE Orders (
    OrderId INT PRIMARY KEY IDENTITY(1,1),
    OrderDate DATETIME2 NOT NULL,
    OrderNo NVARCHAR(50) NOT NULL UNIQUE,
    OrderType NVARCHAR(20) NOT NULL CHECK (OrderType IN ('Dine-in', 'Take-away', 'Online')),
    TableNo NVARCHAR(10) NULL,
    BranchId INT NOT NULL,
    CustomerId INT NULL,
    PaymentMethod NVARCHAR(20) NOT NULL,
    Status NVARCHAR(20) NOT NULL CHECK (Status IN ('Pending', 'Completed', 'Cancelled')),
    CreatedBy INT NOT NULL,
    CreatedAt DATETIME2 NOT NULL DEFAULT GETDATE(),
    FOREIGN KEY (BranchId) REFERENCES Branches(BranchId),
    FOREIGN KEY (CustomerId) REFERENCES Customers(CustomerId),
    FOREIGN KEY (CreatedBy) REFERENCES Users(UserId)
);

-- Table: OrderDetails
CREATE TABLE OrderDetails (
    OrderId INT NOT NULL,
    ProductId INT NOT NULL,
    ProductQuantity DECIMAL(18,2) NOT NULL,
    ProductPrice DECIMAL(18,2) NOT NULL,
    FOREIGN KEY (OrderId) REFERENCES Orders(OrderId) ON DELETE CASCADE,
    FOREIGN KEY (ProductId) REFERENCES Products(ProductId),
    PRIMARY KEY (OrderId,ProductId)
);

-- Table: OrderReturns
CREATE TABLE OrderReturns (
    OrderReturnId INT PRIMARY KEY IDENTITY(1,1),
    OrderReturnDate DATETIME2 NOT NULL,
    OrderId INT NOT NULL,
    CreatedBy INT NOT NULL,
    CreatedAt DATETIME2 NOT NULL DEFAULT GETDATE(),
    FOREIGN KEY (OrderId) REFERENCES Orders(OrderId) ON DELETE CASCADE,
    FOREIGN KEY (CreatedBy) REFERENCES Users(UserId)
);

-- Table: OrderReturnDetails
CREATE TABLE OrderReturnDetails (
    OrderReturnId INT NOT NULL,
    ProductId INT NOT NULL,
    ProductQuantity DECIMAL(18,2) NOT NULL,
    FOREIGN KEY (OrderReturnId) REFERENCES OrderReturns(OrderReturnId) ON DELETE CASCADE,
    FOREIGN KEY (ProductId) REFERENCES Products(ProductId),
    PRIMARY KEY (OrderReturnId,ProductId)
);

-- Table: Accounts
CREATE TABLE Accounts (
    AccountId INT PRIMARY KEY IDENTITY(1,1),
    AccountType NVARCHAR(20) NOT NULL CHECK (AccountType IN ('Bank', 'Cash')),
    AccountTitle NVARCHAR(100) NOT NULL,
    BankName NVARCHAR(100) NULL,
    AccountNumber NVARCHAR(50) NULL,
    Description NVARCHAR(255) NULL,
    CreatedBy INT NOT NULL,
    CreatedAt DATETIME2 NOT NULL DEFAULT GETDATE(),
    ModifiedBy INT NULL,
    ModifiedAt DATETIME2 NULL,
    FOREIGN KEY (CreatedBy) REFERENCES Users(UserId),
    FOREIGN KEY (ModifiedBy) REFERENCES Users(UserId)
);

-- Table: PaymentVouchers
CREATE TABLE PaymentVouchers (
    PaymentVoucherId INT PRIMARY KEY IDENTITY(1,1),
    PaymentVoucherNo NVARCHAR(50) NOT NULL UNIQUE,
    PaymentVoucherDate DATETIME2 NOT NULL,
    VendorId INT NOT NULL,
    PaymentMethod NVARCHAR(20) NOT NULL CHECK (PaymentMethod IN ('Bank', 'Cash')),
    AccountId INT NOT NULL,
    InstrumentNo NVARCHAR(50) NULL,
    InstrumentDate DATETIME2 NULL,
    Amount DECIMAL(18,2) NOT NULL,
    Status NVARCHAR(20) NOT NULL CHECK (Status IN ('Pending', 'Approved', 'Rejected')),
    CreatedBy INT NOT NULL,
    CreatedAt DATETIME2 NOT NULL DEFAULT GETDATE(),
    ModifiedBy INT NULL,
    ModifiedAt DATETIME2 NULL,
    FOREIGN KEY (VendorId) REFERENCES Vendors(VendorId),
    FOREIGN KEY (AccountId) REFERENCES Accounts(AccountId),
    FOREIGN KEY (CreatedBy) REFERENCES Users(UserId),
    FOREIGN KEY (ModifiedBy) REFERENCES Users(UserId)
);

-- Table: PaymentApply
CREATE TABLE PaymentApply (
    PaymentVoucherId INT NOT NULL,
    PurchaseId INT NOT NULL,
    AppliedAmount DECIMAL(18,2) NOT NULL,
    FOREIGN KEY (PaymentVoucherId) REFERENCES PaymentVouchers(PaymentVoucherId) ON DELETE CASCADE,
    FOREIGN KEY (PurchaseId) REFERENCES Purchases(PurchaseId),
    PRIMARY KEY (PaymentVoucherId,PurchaseId)
);

-- Table: PaymentVoucherAttachments
CREATE TABLE PaymentVoucherAttachments (
    VoucherAttachmentId INT PRIMARY KEY IDENTITY(1,1),
    PaymentVoucherId INT NOT NULL,
    AttachmentPath NVARCHAR(255) NOT NULL,
    FOREIGN KEY (PaymentVoucherId) REFERENCES PaymentVouchers(PaymentVoucherId) ON DELETE CASCADE
);

-- Table: ReceiptVouchers
CREATE TABLE ReceiptVouchers (
    ReceiptVoucherId INT PRIMARY KEY IDENTITY(1,1),
    ReceiptVoucherNo NVARCHAR(50) NOT NULL UNIQUE,
    ReceiptVoucherDate DATETIME2 NOT NULL,
    VendorId INT NOT NULL,
    PaymentMethod NVARCHAR(20) NOT NULL CHECK (PaymentMethod IN ('Bank', 'Cash')),
    AccountId INT NOT NULL,
    InstrumentNo NVARCHAR(50) NULL,
    InstrumentDate DATETIME2 NULL,
    Amount DECIMAL(18,2) NOT NULL,
    Status NVARCHAR(20) NOT NULL CHECK (Status IN ('Pending', 'Approved', 'Rejected')),
    CreatedBy INT NOT NULL,
    CreatedAt DATETIME2 NOT NULL DEFAULT GETDATE(),
    ModifiedBy INT NULL,
    ModifiedAt DATETIME2 NULL,
    FOREIGN KEY (VendorId) REFERENCES Vendors(VendorId),
    FOREIGN KEY (AccountId) REFERENCES Accounts(AccountId),
    FOREIGN KEY (CreatedBy) REFERENCES Users(UserId),
    FOREIGN KEY (ModifiedBy) REFERENCES Users(UserId)
);

-- Table: ReceiptApply
CREATE TABLE ReceiptApply (
    ReceiptVoucherId INT NOT NULL,
    PurchaseReturnId INT NOT NULL,
    AppliedAmount DECIMAL(18,2) NOT NULL,
    FOREIGN KEY (ReceiptVoucherId) REFERENCES ReceiptVouchers(ReceiptVoucherId) ON DELETE CASCADE,
    FOREIGN KEY (PurchaseReturnId) REFERENCES PurchasesReturn(PurchaseReturnId),
    PRIMARY KEY (ReceiptVoucherId,PurchaseReturnId)
);

-- Table: ReceiptVoucherAttachments
CREATE TABLE ReceiptVoucherAttachments (
    VoucherAttachmentId INT PRIMARY KEY IDENTITY(1,1),
    ReceiptVoucherId INT NOT NULL,
    AttachmentPath NVARCHAR(255) NOT NULL,
    FOREIGN KEY (ReceiptVoucherId) REFERENCES ReceiptVouchers(ReceiptVoucherId) ON DELETE CASCADE
);


INSERT INTO UnitOfMeasure (Name, Symbol)
VALUES ('Kilogram', 'kg'),
       ('Gram', 'g'),
       ('Liter', 'L'),
       ('Milliliter', 'ml'),
       ('Piece', 'pcs');